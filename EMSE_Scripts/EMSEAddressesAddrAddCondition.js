var debug ="";
showDebug = true;
showMessage = true;
var useProductScript = true;
var runEvent = false;
var SCRIPT_VERSION = 3.0;
servProvCode = aa.getServiceProviderCode();

function getScriptText(vScriptName, servProvCode, useProductScript) {
	vScriptName = vScriptName.toUpperCase();
	var emseBiz = aa.proxyInvoker.newInstance(
			"com.accela.aa.emse.emse.EMSEBusiness").getOutput();
	try {
		if (useProductScript) {
			var emseScript = emseBiz.getMasterScript(aa
					.getServiceProviderCode(), vScriptName);
		} else {
			var emseScript = emseBiz.getScriptByPK(aa.getServiceProviderCode(),
					vScriptName, "ADMIN");
		}
		return emseScript.getScriptText() + "";
	} catch (err) {
		return "";
	}
}
eval(getScriptText("INCLUDES_ACCELA_FUNCTIONS", servProvCode, useProductScript));
eval(getScriptText("INCLUDES_ACCELA_GLOBALS", servProvCode, useProductScript));
//eval(getScriptText("INCLUDES_CUSTOM", servProvCode, useProductScript));

var pAddrNum= null;
//var pAddrNum= aa.env.getValue("pAddrNum");
var pType= aa.env.getValue("pType");
var pStatus= aa.env.getValue("pStatus");
var pDesc= aa.env.getValue("pDesc");
var pComment= aa.env.getValue("pComment");
var pImpact= aa.env.getValue("pImpact");
var pAllowDup= aa.env.getValue("pAllowDup");




var cap = aa.env.getValue("capId");
var result = aa.cap.getCapID(cap);
var capId = result.getOutput();

var appCreateResult = addrAddCondition(pAddrNum, pType, pStatus, pDesc, pComment, pImpact, pAllowDup, capId);


if (debug.indexOf("**ERROR") > 0)
{
aa.env.setValue("ScriptReturnCode", "1");
aa.env.setValue("ScriptReturnMessage", debug);
aa.env.setValue("isSuccess", "false");
}
else
{
aa.env.setValue("ScriptReturnCode", "0");
aa.env.setValue("ScriptReturnMessage", message);
aa.env.setValue("ScriptReturnMessage", debug);
aa.env.setValue("isSuccess", "true");
//aa.env.setValue("ScriptReturnMessage", appCreateResult);
}