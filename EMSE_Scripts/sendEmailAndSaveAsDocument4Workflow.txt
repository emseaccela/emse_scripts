//This is a overload method. 
//Parameters: from, to, cc, subject, content, fileNames, processNoteScriptModel

var id1
var from = "auto@achievo.com";
var to = "balint.li@achievo.com";
var cc = "rocket.luo@achievo.com";
var subject = "Send Email";
var content = "Auto Test Sending Email";
var fileNames = new Array();
var processNoteScriptModel = buildProcessNoteScriptModel();

var result;
result = aa.document.sendEmailAndSaveAsDocument4Workflow(from, to, cc, subject, content, fileNames, processNoteScriptModel);
if (result.getSuccess())
{
    aa.print("Success");
}
else
{
    aa.print("Failed:" + result.getErrorMessage());
}


function buildProcessNoteScriptModel()
{
	processNoteScript = aa.workflow.getProcessNoteScriptModel().getOutput();

	processNoteScript.setServiceProviderCode("AUTOTEST");
	processNoteScript.setAttachTo("CAP");
	processNoteScript.setEdmsName("ACCELA");
	processNoteScript.setDocGroup("DOCUMENT GROUP DANIEL");
	processNoteScript.setDocCategory("DOCUMENT TYPE DANIEL - AUTO");
	processNoteScript.setID1("11TRE");
	processNoteScript.setID2("00000");
	processNoteScript.setID3("00001");

	return processNoteScript;
}